<!DOCTYPE html>
<html lang="uz">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Panel</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Segoe UI', sans-serif; background: #f5f6fa; }
        .login-container { display: flex; justify-content: center; align-items: center; min-height: 100vh; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); }
        .login-box { background: white; padding: 50px; border-radius: 20px; box-shadow: 0 20px 60px rgba(0,0,0,0.3); width: 90%; max-width: 450px; }
        .login-logo { text-align: center; font-size: 70px; margin-bottom: 20px; }
        .login-box h2 { color: #667eea; text-align: center; margin-bottom: 30px; font-size: 32px; }
        #main-content { display: none; }
        .header { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 20px; }
        .container { max-width: 1400px; margin: 0 auto; padding: 20px; }
        .tabs { display: flex; gap: 10px; margin-bottom: 30px; flex-wrap: wrap; }
        .tab-btn { background: white; border: 2px solid #667eea; color: #667eea; padding: 12px 25px; border-radius: 8px; cursor: pointer; font-size: 15px; font-weight: bold; transition: all 0.3s; }
        .tab-btn.active { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; }
        .tab-content { display: none; }
        .tab-content.active { display: block; }
        .card { background: white; border-radius: 15px; padding: 30px; box-shadow: 0 5px 20px rgba(0,0,0,0.1); margin-bottom: 30px; }
        .card h2 { color: #667eea; margin-bottom: 20px; font-size: 24px; }
        .form-group { margin-bottom: 20px; }
        .form-group label { display: block; color: #333; font-weight: bold; margin-bottom: 8px; }
        .form-group input, .form-group select { width: 100%; padding: 12px; border: 2px solid #ddd; border-radius: 8px; font-size: 16px; }
        .form-group input:focus, .form-group select:focus { outline: none; border-color: #667eea; }
        .password-field { position: relative; }
        .password-toggle { position: absolute; right: 15px; top: 50%; transform: translateY(-50%); cursor: pointer; font-size: 20px; }
        .btn { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 12px 30px; border: none; border-radius: 8px; font-size: 16px; font-weight: bold; cursor: pointer; transition: 0.3s; }
        .btn:hover { transform: scale(1.05); }
        .btn-small { padding: 5px 10px; font-size: 14px; }
        .btn-danger { background: linear-gradient(135deg, #f44336 0%, #e91e63 100%); }
        .btn-success { background: linear-gradient(135deg, #4caf50 0%, #8bc34a 100%); }
        table { width: 100%; border-collapse: collapse; margin-top: 20px; }
        table thead { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; }
        table th, table td { padding: 12px; text-align: left; border-bottom: 1px solid #ddd; font-size: 14px; }
        table tbody tr:hover { background: #f5f6fa; }
        .action-btns { display: flex; gap: 5px; }
        .success-message, .error-message { padding: 15px; border-radius: 8px; margin-bottom: 20px; display: none; }
        .success-message { background: #4caf50; color: white; }
        .error-message { background: #f44336; color: white; }
        .stats { display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px; margin-bottom: 30px; }
        .stat-card { background: white; padding: 30px; border-radius: 15px; box-shadow: 0 5px 20px rgba(0,0,0,0.1); text-align: center; cursor: pointer; transition: all 0.3s; }
        .stat-card:hover { transform: translateY(-10px); }
        .stat-card h3 { color: #667eea; font-size: 48px; margin-bottom: 10px; }
        .modal { display: none; position: fixed; z-index: 1000; left: 0; top: 0; width: 100%; height: 100%; background-color: rgba(0,0,0,0.7); }
        .modal-content { background: white; margin: 5% auto; padding: 30px; border-radius: 15px; width: 90%; max-width: 600px; max-height: 80vh; overflow-y: auto; }
        .close-btn { float: right; font-size: 28px; font-weight: bold; cursor: pointer; color: #aaa; }
        .close-btn:hover { color: #667eea; }
    </style>
</head>
<body>
    <div id="login-screen" class="login-container">
        <div class="login-box">
            <div class="login-logo">üéì</div>
            <h2>Admin Panel</h2>
            <div class="form-group">
                <label>Login</label>
                <input type="text" id="loginUsername" placeholder="Login kiriting">
            </div>
            <div class="form-group">
                <label>Parol</label>
                <div class="password-field">
                    <input type="password" id="loginPassword" placeholder="Parol kiriting">
                    <span class="password-toggle" id="toggleBtn">üëÅÔ∏è</span>
                </div>
            </div>
            <button class="btn" style="width: 100%;" id="loginBtn">KIRISH</button>
            <div class="error-message" id="loginError" style="margin-top: 15px;"></div>
        </div>
    </div>

    <div id="main-content">
        <div class="header">
            <div class="container" style="display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap;">
                <h1>üéì Hamidov Academy</h1>
                <button class="btn" id="logoutBtn" style="background: rgba(255,255,255,0.2);">üö™ Chiqish</button>
            </div>
        </div>
        <div class="container">
            <div class="tabs">
                <button class="tab-btn active" data-tab="dashboard">üìä Dashboard</button>
                <button class="tab-btn" data-tab="students">üë®‚Äçüéì O'quvchilar</button>
                <button class="tab-btn" data-tab="teachers">üë®‚Äçüè´ O'qituvchilar</button>
                <button class="tab-btn" data-tab="courses">üìö Kurslar</button>
                <button class="tab-btn" data-tab="settings">‚öôÔ∏è Sozlamalar</button>
            </div>
            
            <div id="dashboard" class="tab-content active">
                <div class="stats">
                    <div class="stat-card"><h3 id="totalStudents">0</h3><p>O'quvchilar</p></div>
                    <div class="stat-card"><h3 id="totalTeachers">0</h3><p>O'qituvchilar</p></div>
                    <div class="stat-card"><h3 id="totalCourses">0</h3><p>Kurslar</p></div>
                </div>
            </div>

            <div id="students" class="tab-content">
                <div class="card">
                    <h2>üë®‚Äçüéì Yangi O'quvchi Qo'shish</h2>
                    <div class="success-message" id="addStudentMsg"></div>
                    <div class="form-group"><label>Ism Familiya *</label><input type="text" id="newStudentName"></div>
                    <div class="form-group"><label>Telefon *</label><input type="tel" id="newStudentPhone"></div>
                    <div class="form-group"><label>Email</label><input type="email" id="newStudentEmail"></div>
                    <div class="form-group"><label>Kurs *</label><select id="newStudentCourse"><option value="">Tanlang</option></select></div>
                    <div class="form-group"><label>Izoh</label><input type="text" id="newStudentComment"></div>
                    <button class="btn" id="addStudentBtn">QO'SHISH</button>
                </div>
                <div class="card">
                    <h2>üìã O'quvchilar Ro'yxati</h2>
                    <div class="success-message" id="studentMsg"></div>
                    <table>
                        <thead><tr><th>ID</th><th>Ism</th><th>Telefon</th><th>Kurs</th><th>Amallar</th></tr></thead>
                        <tbody id="studentsTable"></tbody>
                    </table>
                </div>
            </div>

            <div id="teachers" class="tab-content">
                <div class="card">
                    <h2>üë®‚Äçüè´ Yangi O'qituvchi</h2>
                    <div class="success-message" id="teacherMsg"></div>
                    <div class="form-group"><label>Ism Familiya *</label><input type="text" id="teacherName"></div>
                    <div class="form-group"><label>Telefon *</label><input type="tel" id="teacherPhone"></div>
                    <div class="form-group"><label>Telegram ID *</label><input type="text" id="teacherTelegram"></div>
                    <div class="form-group"><label>Fan *</label><select id="teacherSubject"><option value="">Tanlang</option></select></div>
                    <button class="btn" id="addTeacherBtn">QO'SHISH</button>
                </div>
                <div class="card">
                    <h2>üìã O'qituvchilar Ro'yxati</h2>
                    <table>
                        <thead><tr><th>ID</th><th>Ism</th><th>Telefon</th><th>Fan</th><th>Amallar</th></tr></thead>
                        <tbody id="teachersTable"></tbody>
                    </table>
                </div>
            </div>

            <div id="courses" class="tab-content">
                <div class="card">
                    <h2>üìö Yangi Kurs</h2>
                    <div class="success-message" id="courseMsg"></div>
                    <div class="form-group"><label>Kurs Nomi *</label><input type="text" id="courseName"></div>
                    <div class="form-group"><label>Tavsif *</label><input type="text" id="courseDesc"></div>
                    <div class="form-group"><label>Narxi (so'm) *</label><input type="number" id="coursePrice"></div>
                    <button class="btn" id="addCourseBtn">QO'SHISH</button>
                </div>
                <div class="card">
                    <h2>üìã Kurslar</h2>
                    <table>
                        <thead><tr><th>ID</th><th>Nom</th><th>Tavsif</th><th>Narx</th><th>Amallar</th></tr></thead>
                        <tbody id="coursesTable"></tbody>
                    </table>
                </div>
            </div>

            <div id="settings" class="tab-content">
                <div class="card">
                    <h2>‚öôÔ∏è Sayt Sozlamalari</h2>
                    <div class="success-message" id="settingsMsg"></div>
                    <h3 style="color: #667eea; margin-bottom: 15px;">Manzil</h3>
                    <div class="form-group"><label>O'zbek *</label><input type="text" id="addressUz"></div>
                    <div class="form-group"><label>Rus *</label><input type="text" id="addressRu"></div>
                    <h3 style="color: #667eea; margin: 20px 0 15px;">Telefon</h3>
                    <div class="form-group"><label>Tel 1 *</label><input type="tel" id="phone1"></div>
                    <div class="form-group"><label>Tel 2</label><input type="tel" id="phone2"></div>
                    <h3 style="color: #667eea; margin: 20px 0 15px;">Ish Vaqti</h3>
                    <div class="form-group"><label>O'zbek *</label><input type="text" id="scheduleUz"></div>
                    <div class="form-group"><label>Rus *</label><input type="text" id="scheduleRu"></div>
                    <button class="btn" id="saveSettingsBtn">SAQLASH</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Edit Modals -->
    <div id="editStudentModal" class="modal">
        <div class="modal-content">
            <span class="close-btn" onclick="closeModal('editStudentModal')">&times;</span>
            <h2 style="color: #667eea; margin-bottom: 20px;">O'quvchini Tahrirlash</h2>
            <input type="hidden" id="editStudentId">
            <div class="form-group"><label>Ism *</label><input type="text" id="editStudentName"></div>
            <div class="form-group"><label>Telefon *</label><input type="tel" id="editStudentPhone"></div>
            <div class="form-group"><label>Email</label><input type="email" id="editStudentEmail"></div>
            <div class="form-group"><label>Kurs *</label><select id="editStudentCourse"></select></div>
            <div class="form-group"><label>Izoh</label><input type="text" id="editStudentComment"></div>
            <button class="btn" style="width: 100%;" onclick="saveStudent()">SAQLASH</button>
        </div>
    </div>

    <div id="editTeacherModal" class="modal">
        <div class="modal-content">
            <span class="close-btn" onclick="closeModal('editTeacherModal')">&times;</span>
            <h2 style="color: #667eea; margin-bottom: 20px;">O'qituvchini Tahrirlash</h2>
            <input type="hidden" id="editTeacherId">
            <div class="form-group"><label>Ism *</label><input type="text" id="editTeacherName"></div>
            <div class="form-group"><label>Telefon *</label><input type="tel" id="editTeacherPhone"></div>
            <div class="form-group"><label>Telegram ID *</label><input type="text" id="editTeacherTelegram"></div>
            <div class="form-group"><label>Fan *</label><select id="editTeacherSubject"></select></div>
            <button class="btn" style="width: 100%;" onclick="saveTeacher()">SAQLASH</button>
        </div>
    </div>

    <div id="editCourseModal" class="modal">
        <div class="modal-content">
            <span class="close-btn" onclick="closeModal('editCourseModal')">&times;</span>
            <h2 style="color: #667eea; margin-bottom: 20px;">Kursni Tahrirlash</h2>
            <input type="hidden" id="editCourseId">
            <div class="form-group"><label>Nom *</label><input type="text" id="editCourseName"></div>
            <div class="form-group"><label>Tavsif *</label><input type="text" id="editCourseDesc"></div>
            <div class="form-group"><label>Narx *</label><input type="number" id="editCoursePrice"></div>
            <button class="btn" style="width: 100%;" onclick="saveCourse()">SAQLASH</button>
        </div>
    </div>

    <script>
        let students = JSON.parse(localStorage.getItem('students')) || [];
        let teachers = JSON.parse(localStorage.getItem('teachers')) || [];
        let courses = JSON.parse(localStorage.getItem('courses')) || [
            {id: 1, name: 'Matematika', desc: 'Algebra, Geometriya', price: '400000'},
            {id: 2, name: 'Ingliz tili', desc: 'IELTS tayyorgarlik', price: '350000'},
            {id: 3, name: 'Fizika', desc: 'Mexanika', price: '400000'}
        ];
        let settings = JSON.parse(localStorage.getItem('siteSettings')) || {
            addressUz: 'Toshkent sh., Yunusobod', addressRu: '–≥. –¢–∞—à–∫–µ–Ω—Ç, –Æ–Ω—É—Å–∞–±–∞–¥',
            phone1: '+998901234567', phone2: '+998912345678',
            scheduleUz: 'Dushanba-Shanba: 09:00-20:00', scheduleRu: '–ü–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫-–°—É–±–±–æ—Ç–∞: 09:00-20:00'
        };

        localStorage.setItem('courses', JSON.stringify(courses));

        // Toggle password
        document.getElementById('toggleBtn').onclick = function() {
            const pwd = document.getElementById('loginPassword');
            if (pwd.type === 'password') {
                pwd.type = 'text';
                this.textContent = 'üëÅÔ∏è‚Äçüó®Ô∏è';
            } else {
                pwd.type = 'password';
                this.textContent = 'üëÅÔ∏è';
            }
        };

        // Login
        document.getElementById('loginBtn').onclick = function() {
            const user = document.getElementById('loginUsername').value;
            const pass = document.getElementById('loginPassword').value;
            if (user === 'Admin' && pass === 'Hamidov2025') {
                document.getElementById('login-screen').style.display = 'none';
                document.getElementById('main-content').style.display = 'block';
                sessionStorage.setItem('loggedIn', 'true');
                loadAll();
            } else {
                showMsg('loginError', 'Login yoki parol noto\'g\'ri!', 'error');
            }
        };

        // Logout
        document.getElementById('logoutBtn').onclick = function() {
            if (confirm('Chiqmoqchimisiz?')) {
                sessionStorage.clear();
                location.reload();
            }
        };

        // Tabs
        document.querySelectorAll('.tab-btn').forEach(btn => {
            btn.onclick = function() {
                const tab = this.getAttribute('data-tab');
                document.querySelectorAll('.tab-content').forEach(t => t.classList.remove('active'));
                document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
                document.getElementById(tab).classList.add('active');
                this.classList.add('active');
                if (tab === 'students') loadStudentCourses();
                if (tab === 'teachers') loadTeacherSubjects();
            }
        });

        // Add Student
        document.getElementById('addStudentBtn').onclick = function() {
            const name = document.getElementById('newStudentName').value;
            const phone = document.getElementById('newStudentPhone').value;
            const email = document.getElementById('newStudentEmail').value;
            const course = document.getElementById('newStudentCourse').value;
            const comment = document.getElementById('newStudentComment').value;
            if (name && phone && course) {
                students.push({id: Date.now(), fullName: name, phone, email, course, comment, date: new Date().toLocaleString(), teacher: null});
                localStorage.setItem('students', JSON.stringify(students));
                showMsg('addStudentMsg', 'O\'quvchi qo\'shildi!');
                loadStudents();
                updateStats();
                document.getElementById('newStudentName').value = '';
                document.getElementById('newStudentPhone').value = '';
                document.getElementById('newStudentEmail').value = '';
                document.getElementById('newStudentCourse').value = '';
                document.getElementById('newStudentComment').value = '';
            }
        };

        // Add Teacher
        document.getElementById('addTeacherBtn').onclick = function() {
            const name = document.getElementById('teacherName').value;
            const phone = document.getElementById('teacherPhone').value;
            const telegram = document.getElementById('teacherTelegram').value;
            const subject = document.getElementById('teacherSubject').value;
            if (name && phone && telegram && subject) {
                teachers.push({id: Date.now(), name, phone, telegram, subject, students: []});
                localStorage.setItem('teachers', JSON.stringify(teachers));
                showMsg('teacherMsg', 'O\'qituvchi qo\'shildi!');
                loadTeachers();
                updateStats();
                document.getElementById('teacherName').value = '';
                document.getElementById('teacherPhone').value = '';
                document.getElementById('teacherTelegram').value = '';
                document.getElementById('teacherSubject').value = '';
            }
        };

        // Add Course
        document.getElementById('addCourseBtn').onclick = function() {
            const name = document.getElementById('courseName').value;
            const desc = document.getElementById('courseDesc').value;
            const price = document.getElementById('coursePrice').value;
            if (name && desc && price) {
                courses.push({id: Date.now(), name, desc, price});
                localStorage.setItem('courses', JSON.stringify(courses));
                localStorage.setItem('coursesUpdated', Date.now());
                showMsg('courseMsg', 'Kurs qo\'shildi!');
                loadCourses();
                updateStats();
                document.getElementById('courseName').value = '';
                document.getElementById('courseDesc').value = '';
                document.getElementById('coursePrice').value = '';
            }
        };

        // Save Settings
        document.getElementById('saveSettingsBtn').onclick = function() {
            settings = {
                addressUz: document.getElementById('addressUz').value,
                addressRu: document.getElementById('addressRu').value,
                phone1: document.getElementById('phone1').value,
                phone2: document.getElementById('phone2').value,
                scheduleUz: document.getElementById('scheduleUz').value,
                scheduleRu: document.getElementById('scheduleRu').value
            };
            localStorage.setItem('siteSettings', JSON.stringify(settings));
            localStorage.setItem('settingsUpdated', Date.now());
            showMsg('settingsMsg', 'Saqlandi!');
        };

        // Edit/Delete Functions
        function editStudent(id) {
            const s = students.find(x => x.id === id);
            if (!s) return;
            document.getElementById('editStudentId').value = s.id;
            document.getElementById('editStudentName').value = s.fullName;
            document.getElementById('editStudentPhone').value = s.phone;
            document.getElementById('editStudentEmail').value = s.email || '';
            document.getElementById('editStudentComment').value = s.comment || '';
            const select = document.getElementById('editStudentCourse');
            select.innerHTML = courses.map(c => `<option value="${c.name}" ${c.name === s.course ? 'selected' : ''}>${c.name}</option>`).join('');
            document.getElementById('editStudentModal').style.display = 'block';
        }

        function saveStudent() {
            const id = parseInt(document.getElementById('editStudentId').value);
            const s = students.find(x => x.id === id);
            if (s) {
                s.fullName = document.getElementById('editStudentName').value;
                s.phone = document.getElementById('editStudentPhone').value;
                s.email = document.getElementById('editStudentEmail').value;
                s.course = document.getElementById('editStudentCourse').value;
                s.comment = document.getElementById('editStudentComment').value;
                localStorage.setItem('students', JSON.stringify(students));
                closeModal('editStudentModal');
                loadStudents();
                showMsg('studentMsg', 'O\'quvchi yangilandi!');
            }
        }

        function deleteStudent(id) {
            if (confirm('O\'chirishni xohlaysizmi?')) {
                students = students.filter(x => x.id !== id);
                localStorage.setItem('students', JSON.stringify(students));
                loadStudents();
                updateStats();
                showMsg('studentMsg', 'O\'quvchi o\'chirildi!');
            }
        }

        function editTeacher(id) {
            const t = teachers.find(x => x.id === id);
            if (!t) return;
            document.getElementById('editTeacherId').value = t.id;
            document.getElementById('editTeacherName').value = t.name;
            document.getElementById('editTeacherPhone').value = t.phone;
            document.getElementById('editTeacherTelegram').value = t.telegram;
            const select = document.getElementById('editTeacherSubject');
            select.innerHTML = courses.map(c => `<option value="${c.name}" ${c.name === t.subject ? 'selected' : ''}>${c.name}</option>`).join('');
            document.getElementById('editTeacherModal').style.display = 'block';
        }

        function saveTeacher() {
            const id = parseInt(document.getElementById('editTeacherId').value);
            const t = teachers.find(x => x.id === id);
            if (t) {
                t.name = document.getElementById('editTeacherName').value;
                t.phone = document.getElementById('editTeacherPhone').value;
                t.telegram = document.getElementById('editTeacherTelegram').value;
                t.subject = document.getElementById('editTeacherSubject').value;
                localStorage.setItem('teachers', JSON.stringify(teachers));
                closeModal('editTeacherModal');
                loadTeachers();
                showMsg('teacherMsg', 'O\'qituvchi yangilandi!');
            }
        }

        function deleteTeacher(id) {
            if (confirm('O\'chirishni xohlaysizmi?')) {
                teachers = teachers.filter(x => x.id !== id);
                localStorage.setItem('teachers', JSON.stringify(teachers));
                loadTeachers();
                updateStats();
                showMsg('teacherMsg', 'O\'qituvchi o\'chirildi!');
            }
        }

        function editCourse(id) {
            const c = courses.find(x => x.id === id);
            if (!c) return;
            document.getElementById('editCourseId').value = c.id;
            document.getElementById('editCourseName').value = c.name;
            document.getElementById('editCourseDesc').value = c.desc;
            document.getElementById('editCoursePrice').value = c.price;
            document.getElementById('editCourseModal').style.display = 'block';
        }

        function saveCourse() {
            const id = parseInt(document.getElementById('editCourseId').value);
            const c = courses.find(x => x.id === id);
            if (c) {
                c.name = document.getElementById('editCourseName').value;
                c.desc = document.getElementById('editCourseDesc').value;
                c.price = document.getElementById('editCoursePrice').value;
                localStorage.setItem('courses', JSON.stringify(courses));
                localStorage.setItem('coursesUpdated', Date.now());
                closeModal('editCourseModal');
                loadCourses();
                showMsg('courseMsg', 'Kurs yangilandi!');
            }
        }

        function deleteCourse(id) {
            if (confirm('O\'chirishni xohlaysizmi?')) {
                courses = courses.filter(x => x.id !== id);
                localStorage.setItem('courses', JSON.stringify(courses));
                localStorage.setItem('coursesUpdated', Date.now());
                loadCourses();
                updateStats();
                showMsg('courseMsg', 'Kurs o\'chirildi!');
            }
        }

        function closeModal(id) {
            document.getElementById(id).style.display = 'none';
        }

        // Load Functions
        function loadAll() {
            loadStudents();
            loadTeachers();
            loadCourses();
            loadSettings();
            loadStudentCourses();
            loadTeacherSubjects();
            updateStats();
        }

        function loadStudents() {
            const tbody = document.getElementById('studentsTable');
            tbody.innerHTML = students.length ? students.map((s, i) => 
                `<tr><td>${i+1}</td><td>${s.fullName}</td><td>${s.phone}</td><td>${s.course}</td>
                <td class="action-btns">
                    <button class="btn btn-small" onclick="editStudent(${s.id})">‚úèÔ∏è</button>
                    <button class="btn btn-small btn-danger" onclick="deleteStudent(${s.id})">üóëÔ∏è</button>
                </td></tr>`
            ).join('') : '<tr><td colspan="5">Ma\'lumot yo\'q</td></tr>';
        }

        function loadTeachers() {
            const tbody = document.getElementById('teachersTable');
            tbody.innerHTML = teachers.length ? teachers.map((t, i) => 
                `<tr><td>${i+1}</td><td>${t.name}</td><td>${t.phone}</td><td>${t.subject}</td>
                <td class="action-btns">
                    <button class="btn btn-small" onclick="editTeacher(${t.id})">‚úèÔ∏è</button>
                    <button class="btn btn-small btn-danger" onclick="deleteTeacher(${t.id})">üóëÔ∏è</button>
                </td></tr>`
            ).join('') : '<tr><td colspan="5">Ma\'lumot yo\'q</td></tr>';
        }

        function loadCourses() {
            const tbody = document.getElementById('coursesTable');
            tbody.innerHTML = courses.map((c, i) => 
                `<tr><td>${i+1}</td><td>${c.name}</td><td>${c.desc}</td><td>${parseInt(c.price).toLocaleString()} so'm</td>
                <td class="action-btns">
                    <button class="btn btn-small" onclick="editCourse(${c.id})">‚úèÔ∏è</button>
                    <button class="btn btn-small btn-danger" onclick="deleteCourse(${c.id})">üóëÔ∏è</button>
                </td></tr>`
            ).join('');
        }

        function loadSettings() {
            document.getElementById('addressUz').value = settings.addressUz;
            document.getElementById('addressRu').value = settings.addressRu;
            document.getElementById('phone1').value = settings.phone1;
            document.getElementById('phone2').value = settings.phone2;
            document.getElementById('scheduleUz').value = settings.scheduleUz;
            document.getElementById('scheduleRu').value = settings.scheduleRu;
        }

        function loadStudentCourses() {
            const select = document.getElementById('newStudentCourse');
            select.innerHTML = '<option value="">Tanlang</option>' + 
                courses.map(c => `<option value="${c.name}">${c.name}</option>`).join('');
        }

        function loadTeacherSubjects() {
            const select = document.getElementById('teacherSubject');
            select.innerHTML = '<option value="">Tanlang</option>' + 
                courses.map(c => `<option value="${c.name}">${c.name}</option>`).join('');
        }

        function updateStats() {
            document.getElementById('totalStudents').textContent = students.length;
            document.getElementById('totalTeachers').textContent = teachers.length;
            document.getElementById('totalCourses').textContent = courses.length;
        }

        function showMsg(id, text, type = 'success') {
            const el = document.getElementById(id);
            el.textContent = text;
            el.className = type === 'success' ? 'success-message' : 'error-message';
            el.style.display = 'block';
            setTimeout(() => el.style.display = 'none', 3000);
        }

        // Auto-login
        if (sessionStorage.getItem('loggedIn')) {
            document.getElementById('login-screen').style.display = 'none';
            document.getElementById('main-content').style.display = 'block';
            loadAll();
        }

        // Close modal on outside click
        window.onclick = function(event) {
            if (event.target.classList.contains('modal')) {
                event.target.style.display = 'none';
            }
        };
    </script>
</body>
</html>
